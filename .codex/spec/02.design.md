# Design

---
status: ready
design_fingerprint: e56ffe408e966d38857c3aca19fd1e481ffa409e
---

## Architecture Overview
- Web UI: lightweight React SPA (Vite), mobile‑first responsive (no SSR) for brief input, per‑platform editors, and export.
- Generation Service wrapping an LLM with platform-specific templates and constraints.
- Template/Platform Profiles store limits, tone presets, and handle rules.
- Persistence: start local storage/session; plan API + DB later.

## Components
- Web.UI
  - Responsibility: brief input, platform selection, per-platform editors, export.
  - Public Interfaces: web routes and API calls.
  - Implementation: React + Vite; state via React hooks/context; lightweight router; CSS Modules or Tailwind for styling.
  - Responsive: mobile‑first breakpoints (sm/md/lg); flex/grid layout; touch targets ≥ 44px; keyboard and screen‑reader accessible; prefers‑color‑scheme aware.
- Service.Generator
  - Responsibility: transform brief → per-platform drafts using templates and constraints.
  - Public Interfaces: function `generateDrafts(brief, platforms, tone)`; REST `POST /api/generate`.
  - Implementation: uses OpenAI-compatible APIs; model selection is server-side and fixed (no user choice).
- Service.Templates
  - Responsibility: platform profiles (limits, tone presets, handle/hashtag rules).
  - Public Interfaces: `getTemplate(platform)`.
- Service.Validation
  - Responsibility: validate text against platform constraints; compute fit metrics.
  - Public Interfaces: `validateDraft(platform, text)`.
- Service.Analytics
  - Responsibility: track user actions and generation outcomes.
  - Public Interfaces: `track(event)`.
- Data.Storage
  - Responsibility: session/local storage now; evolve to API+DB later.
  - Public Interfaces: `saveDraft(sessionId, draft)`, `loadDrafts(sessionId)`.

## Public Interfaces (external)
- POST `/api/generate`
  - Body: `{ brief, platforms: string[], tone: 'friendly'|'professional'|'witty' }`
  - 200: `{ drafts: { [platform]: { text, fit: { withinLimit: boolean, charsRemaining: number } } } }`
- GET `/api/drafts?sessionId=...` → returns `{ drafts: Draft[] }`
- PUT `/api/drafts/{id}` → upsert a single draft

## Data
- Brief: objective, audience, key messages, CTA, platforms, tone.
- Draft: platform, text, tokens (hashtags/mentions), fit/validation.

## Configuration
- `OPENAI_API_BASE` — OpenAI-compatible API base URL
- `OPENAI_API_KEY` — API key for LLM provider
- `LLM_MODEL` — default model name (fixed server-side)

## Dependency Policy
- Allowed
  - Web.UI → Service.Generator, Service.Validation, Service.Analytics
  - Service.Generator → Service.Templates, Service.Validation
  - Service.Validation → Service.Templates
  - Any Service → Data.Storage
- Forbidden
  - Services → Web.UI (no upward deps)
  - Web.UI → Data.Storage direct (go through services)
  - Cycles between services

## Quality Budgets
- `web_ttfb_ms`: 500
- `ui_interaction_ms`: 100
- `gen_p95_s`: 3
- `api_p95_ms`: 800
- `bundle_kb_gzip`: 300
  - Notes: budgets evaluated on mid‑tier mobile (throttled CPU, slow 4G) to ensure good handheld experience.

## Risks & NFR
- Privacy/PII: avoid logging sensitive briefs; configurable retention.
- Performance: generation ≤ 3s for typical brief; UI ≤ 100ms interactions.
- Responsive: supports small screens; layouts adapt across breakpoints; interactive controls usable via touch and keyboard.

## Open Questions
- Auth and multi-tenant needs (anonymous vs. account)?
- Data retention for saved drafts and analytics events?
- i18n and character counting for non-Latin scripts?
- Accessibility requirements (keyboard, screen reader) for editors?

## Decisions
- LLM usage: Use OpenAI-compatible APIs; the model is configured server-side and not user-selectable.
- Web UI: React SPA with Vite (no SSR) to keep bundle small and DX fast.
- UI Responsiveness: Mobile‑first design with accessible, touch‑friendly controls and adaptive layouts.
